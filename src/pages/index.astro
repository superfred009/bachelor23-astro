---
import Layout from '../layouts/Layout.astro';
import Component from '../components/Component';
import '../styles/global.css';
import { performHeavyLoad } from '../components/heavyLoad';




let heavyLoadResult = null;
(async function () {
  heavyLoadResult = await performHeavyLoad();
})();


const res1 = await fetch('https://dummyjson.com/products');
const data1 = await res1.json();
const products1 = data1.products;

const res2 = await fetch('https://dummyjson.com/products');
const data2 = await res2.json();
const products2 = data2.products;

const combinedProducts = [...products1, ...products2];
---

<Layout title="Welcome to Astro.">
  <main>
    <p>Heavy load v2 execution time: {heavyLoadResult.executionTime} milliseconds</p>
    <p>Last prime number found: {heavyLoadResult.primes[heavyLoadResult.primes.length - 1]}</p>
    <Component products={combinedProducts} client:load />
  </main>
</Layout>
